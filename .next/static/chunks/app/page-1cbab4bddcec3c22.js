(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{419:(e,t,o)=>{"use strict";o.d(t,{J:()=>r,v:()=>l});var a=o(5155),s=o(2115);let n=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[o,l]=(0,s.useState)(!1),[r,d]=(0,s.useState)(0),[i,c]=(0,s.useState)([]),[x,m]=(0,s.useState)({id:"0",endTime:Date.now()+6048e5,resolved:!1,outcome:0,hasClaimed:!1});return(0,s.useEffect)(()=>{let e=localStorage.getItem("wendao_coins"),t=localStorage.getItem("wendao_bets"),o=localStorage.getItem("wendao_is_guest"),a=localStorage.getItem("wendao_mock_market");e&&d(parseInt(e)),t&&c(JSON.parse(t)),"true"===o&&l(!0),a&&m(JSON.parse(a))},[]),(0,s.useEffect)(()=>{localStorage.setItem("wendao_coins",r.toString()),localStorage.setItem("wendao_bets",JSON.stringify(i)),localStorage.setItem("wendao_is_guest",o.toString()),localStorage.setItem("wendao_mock_market",JSON.stringify(x))},[r,i,o,x]),(0,a.jsx)(n.Provider,{value:{isGuest:o,daoCoins:r,guestBets:i,mockMarket:x,shareToEarn:()=>{let e=new Date().toDateString(),t=localStorage.getItem("wendao_share_data"),o=0;if(t){let a=JSON.parse(t);a.date===e&&(o=a.count)}if(o>=5)return void alert("❌ 今日分享已达上限 (".concat(5,"次)\n明天再来吧！"));let a=window.location.href||"https://wendao.xyz";navigator.clipboard.writeText("\uD83D\uDD2E 问DAO - 预测市场\n\n我在问DAO下注了！来一起玩吧：\n".concat(a)),localStorage.setItem("wendao_share_data",JSON.stringify({date:e,count:o+1})),d(e=>e+1);let s=5-o-1;alert("\uD83C\uDF89 分享成功！获得 ".concat(1," 道币\n\uD83D\uDCCB 链接已复制\n今日剩余 ").concat(s," 次分享机会"))},placeGuestBet:(e,t,o)=>o>r?(alert("道币不足！"),!1):o<=0?(alert("请输入有效金额"),!1):(d(e=>e-o),c(a=>[...a,{marketId:e,direction:t,amount:o,timestamp:Date.now()}]),!0),adminResolveMarket:e=>{m(t=>({...t,resolved:!0,outcome:e}))},claimMockWinnings:()=>{let e=i.find(e=>"0"===e.marketId);if(e&&!x.hasClaimed&&(1===x.outcome&&"YES"===e.direction||2===x.outcome&&"NO"===e.direction)){let t=i.filter(e=>"0"===e.marketId&&"YES"===e.direction).reduce((e,t)=>e+t.amount,1e3),o=i.filter(e=>"0"===e.marketId&&"NO"===e.direction).reduce((e,t)=>e+t.amount,1e3),a=1===x.outcome?t:o,s=Math.floor(e.amount/a*(t+o));d(e=>e+s),m(e=>({...e,hasClaimed:!0})),alert("\uD83C\uDF89 恭喜！获得 ".concat(s," 道币！"))}},resetMockMarket:()=>{m({id:"0",endTime:Date.now()+6048e5,resolved:!1,outcome:0,hasClaimed:!1}),c([]),alert("市场已重置")},loginAsGuest:()=>{l(!0),d(100),alert("\uD83C\uDF89 欢迎！您获得了 100 道币作为新人奖励！")},logoutGuest:()=>{l(!1),d(0),c([])}},children:t})}function r(){let e=(0,s.useContext)(n);if(!e)throw Error("useUser must be used within UserProvider");return e}},926:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>m});var a=o(5155),s=o(2115),n=o(2619),l=o.n(n),r=o(419),d=o(5239);function i(){let{isGuest:e,daoCoins:t,shareToEarn:o,loginAsGuest:s,logoutGuest:n}=(0,r.J)();return(0,a.jsx)("nav",{className:"bg-[#0d5c4c] text-white shadow-lg border-b-2 border-[#d4af37]/30",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-3 flex justify-between items-center",children:[(0,a.jsxs)(l(),{href:"/",className:"flex items-center gap-3 group",children:[(0,a.jsx)("div",{className:"relative w-10 h-10",children:(0,a.jsx)(d.default,{src:"/dao-coin.png",alt:"问DAO",width:40,height:40,className:"group-hover:rotate-180 transition-transform duration-700"})}),(0,a.jsx)("span",{className:"text-2xl font-bold text-[#d4af37] tracking-wider",children:"问DAO"})]}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-[#d4af37]/20 rounded-lg border border-[#d4af37]/40",children:[(0,a.jsxs)("span",{className:"text-[#d4af37] font-bold",children:["☯️ ",t]}),(0,a.jsx)("span",{className:"text-xs text-[#d4af37]/80",children:"道币"})]}),(0,a.jsx)("button",{onClick:o,className:"px-4 py-2 bg-[#d4af37]/10 text-[#d4af37] rounded-lg hover:bg-[#d4af37]/20 transition border border-[#d4af37]/30 font-medium",children:"\uD83D\uDD17 分享得币"}),(0,a.jsx)("button",{onClick:n,className:"px-4 py-2 text-white/70 hover:text-white transition",children:"退出"})]}):(0,a.jsx)("button",{onClick:s,className:"px-6 py-2 bg-[#d4af37] text-[#0d5c4c] rounded-lg font-bold hover:bg-[#e5c048] transition shadow-lg",children:"登录 / 注册"})})]})})}function c(e){let{id:t,question:o,totalYes:n,totalNo:l,onBet:r,isResolved:d,outcome:i,endTime:c,icon:x="\uD83D\uDD2E"}=e,m=n+l,u=m>0?(n/m*100).toFixed(1):"50",h=m>0?(l/m*100).toFixed(1):"50",[g,f]=(0,s.useState)(""),[b,p]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(!c)return;let e=()=>{let e=c-Date.now();if(e<=0){f("已截止"),p(!0);return}let t=Math.floor(e/864e5),o=Math.floor(e%864e5/36e5),a=Math.floor(e%36e5/6e4),s=Math.floor(e%6e4/1e3);t>0?f("".concat(t,"天 ").concat(o,"时 ").concat(a,"分")):o>0?f("".concat(o,"时 ").concat(a,"分 ").concat(s,"秒")):f("".concat(a,"分 ").concat(s,"秒"))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[c]),(0,a.jsxs)("div",{className:"bg-[#faf8f5] border-2 border-[#0d5c4c]/20 rounded-xl p-4 shadow-lg hover:shadow-xl transition-all hover:border-[#d4af37]/40 flex flex-col h-[240px]",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 h-[56px]",children:[(0,a.jsx)("span",{className:"text-2xl",children:x}),(0,a.jsx)("h3",{className:"text-[#0d5c4c] font-bold text-sm leading-tight line-clamp-2",children:o})]}),d&&i&&(0,a.jsxs)("div",{className:"mt-2 px-3 py-1 rounded-lg text-xs font-bold text-center ".concat("YES"===i?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:["已结束: ","YES"===i?"✅ 是":"❌ 否"]}),(0,a.jsx)("div",{className:"h-[68px] flex flex-col justify-center mt-2 bg-[#0d5c4c]/[0.15] rounded-lg p-2",children:c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-[10px] text-[#0d5c4c]/70 text-center",children:["截止: ",new Date(c).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})]}),(0,a.jsx)("p",{className:"text-sm font-bold text-center truncate ".concat(b?"text-red-600":"text-[#0d5c4c]"),children:b?"⏰ 已截止":"⏳ ".concat(g)})]})}),(0,a.jsxs)("div",{className:"flex gap-2 mt-auto",children:[(0,a.jsxs)("button",{onClick:()=>r(t,"YES"),disabled:b||d,className:"flex-1 py-2 rounded-lg text-sm font-bold transition bg-green-500/20 text-green-700 hover:bg-green-500/30 disabled:opacity-50 disabled:cursor-not-allowed",children:["✅ 是 ",u,"%"]}),(0,a.jsxs)("button",{onClick:()=>r(t,"NO"),disabled:b||d,className:"flex-1 py-2 rounded-lg text-sm font-bold transition bg-red-500/20 text-red-700 hover:bg-red-500/30 disabled:opacity-50 disabled:cursor-not-allowed",children:["❌ 否 ",h,"%"]})]})]})}function x(e){let{isOpen:t,onClose:o,marketId:n,direction:l}=e,[d,i]=(0,s.useState)(""),{placeGuestBet:c,daoCoins:x}=(0,r.J)(),[m,u]=(0,s.useState)(!1),h=async()=>{d&&c(n,l,parseFloat(d))&&(u(!0),setTimeout(()=>{o(),u(!1),i("")},1500))};return t?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 shadow-2xl animate-in fade-in zoom-in duration-200 border-2 border-[#0d5c4c]/20",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4 flex justify-between text-[#0d5c4c]",children:[(0,a.jsxs)("span",{children:["下注 ","YES"===l?"✅ 是":"❌ 否"]}),(0,a.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"道币数量"}),(0,a.jsx)("input",{type:"number",value:d,onChange:e=>i(e.target.value),className:"w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#0d5c4c] focus:border-[#0d5c4c] outline-none transition text-gray-900 placeholder-gray-400",placeholder:"输入数量"})]}),(0,a.jsx)("button",{onClick:h,disabled:!d||parseFloat(d)>x,className:"w-full bg-gradient-to-r from-[#0d5c4c] to-[#1a7f6a] hover:opacity-90 text-white font-bold py-3 rounded-xl transition disabled:opacity-50",children:"确认下注"}),m&&(0,a.jsx)("p",{className:"text-sm text-green-600 text-center font-bold",children:"\uD83C\uDF89 下注成功！"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400 text-center mt-2",children:["当前余额: ",x," 道币"]})]})]})}):null}function m(){let[e,t]=(0,s.useState)(!1),[o,n]=(0,s.useState)(null),[l,d]=(0,s.useState)(!1),{isGuest:m,daoCoins:u,guestBets:h,mockMarket:g,adminResolveMarket:f,claimMockWinnings:b,resetMockMarket:p}=(0,r.J)();(0,s.useEffect)(()=>{d("true"===new URLSearchParams(window.location.search).get("admin"))},[]);let N=h.filter(e=>"0"===e.marketId&&"YES"===e.direction).reduce((e,t)=>e+t.amount,1e3),j=h.filter(e=>"0"===e.marketId&&"NO"===e.direction).reduce((e,t)=>e+t.amount,1e3),v=N+j;(N/v*100).toFixed(2),(j/v*100).toFixed(2);let w={id:"0",question:(g.resolved,"比特币在2025年底会突破15万美金吗？"),endTime:g.endTime,totalYes:N,totalNo:j,rewardPool:v,resolved:g.resolved,outcome:g.outcome},D=(e,o)=>{n({id:e,direction:o}),t(!0)},S=h.find(e=>"0"===e.marketId),y=!!S,C=null==S?void 0:S.direction,k=(null==S?void 0:S.amount)||0,E=S&&g.resolved&&(1===g.outcome&&"YES"===C||2===g.outcome&&"NO"===C)?Math.floor(k/(1===g.outcome?N:j)*v):0;return(0,a.jsxs)("main",{className:"min-h-screen bg-gray-50 pb-20",children:[(0,a.jsx)(i,{}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 mt-8",children:[l&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-red-50 rounded-lg border border-red-200 flex items-center justify-between text-sm",children:[(0,a.jsxs)("span",{className:"text-red-700 font-medium",children:["\uD83D\uDD27 管理员模式 | 池: Yes ",N," / No ",j]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[g.resolved?(0,a.jsxs)("span",{className:"text-green-700 font-bold",children:["✅ 已裁决: ",1===g.outcome?"YES":"NO"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>f(1),className:"px-3 py-1 bg-green-600 text-white rounded text-xs font-bold hover:bg-green-700",children:"裁决 YES"}),(0,a.jsx)("button",{onClick:()=>f(2),className:"px-3 py-1 bg-red-600 text-white rounded text-xs font-bold hover:bg-red-700",children:"裁决 NO"})]}),(0,a.jsx)("button",{onClick:p,className:"px-3 py-1 bg-gray-600 text-white rounded text-xs font-bold hover:bg-gray-700",children:"重置"})]})]}),(0,a.jsxs)("div",{className:"mb-6 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-[#0d5c4c] mb-2",style:{fontFamily:"Noto Serif SC, serif"},children:"天机预测 \xb7 热门事件"}),(0,a.jsx)("p",{className:"text-[#0d5c4c]/60 text-sm",children:"用道币参与预测，赢取奖励"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsx)(c,{id:w.id,question:w.question,totalYes:w.totalYes,totalNo:w.totalNo,onBet:D,isResolved:w.resolved,outcome:1===w.outcome?"YES":2===w.outcome?"NO":void 0,endTime:w.endTime,icon:"₿"}),(0,a.jsx)(c,{id:"1",question:"以太坊在2026年Q1会突破 $5,000 吗？",totalYes:580,totalNo:420,onBet:D,endTime:Date.now()+94176e5,icon:"⟠"}),(0,a.jsx)(c,{id:"2",question:"Solana 生态 TVL 在 2025年底会超越 BSC 吗？",totalYes:400,totalNo:700,onBet:D,endTime:Date.now()+1728e6,icon:"☀️"}),(0,a.jsx)(c,{id:"3",question:"美联储2025年会降息超过3次吗？",totalYes:800,totalNo:700,onBet:D,endTime:Date.now()+1728e6,icon:"\uD83C\uDFE6"}),(0,a.jsx)(c,{id:"4",question:"特斯拉股价在2025年底会超过 $500 吗？",totalYes:450,totalNo:550,onBet:D,endTime:Date.now()+1728e6,icon:"\uD83D\uDE97"}),(0,a.jsx)(c,{id:"5",question:"中国GDP增速2025年会超过5%吗？",totalYes:600,totalNo:506,onBet:D,endTime:Date.now()+432e7,icon:"\uD83C\uDDE8\uD83C\uDDF3"})]}),m&&y&&(0,a.jsxs)("div",{className:"mt-8 p-5 bg-white rounded-xl shadow-lg border-2 border-[#0d5c4c]/20",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-[#0d5c4c] mb-3",children:"\uD83D\uDCCA 我的下注"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-gray-600",children:["下注 ",(0,a.jsx)("span",{className:"font-bold ".concat("YES"===C?"text-green-600":"text-red-600"),children:C})," | ",k," 道币"]}),g.resolved&&(0,a.jsx)("p",{className:"mt-1 font-bold ".concat(E>0?"text-green-600":"text-red-600"),children:E>0?"\uD83C\uDF89 赢得 ".concat(E," 道币！"):"\uD83D\uDE22 未中奖"})]}),g.resolved&&E>0&&!g.hasClaimed&&(0,a.jsx)("button",{onClick:b,className:"px-6 py-2 bg-[#d4af37] text-[#0d5c4c] rounded-lg font-bold hover:bg-[#e5c048] transition shadow-lg",children:"领取奖励"}),g.hasClaimed&&(0,a.jsx)("span",{className:"text-green-600 font-bold",children:"✅ 已领取"})]})]})]}),(0,a.jsx)(x,{isOpen:e,onClose:()=>t(!1),marketId:(null==o?void 0:o.id)||"0",direction:(null==o?void 0:o.direction)||"YES"})]})}},6235:(e,t,o)=>{Promise.resolve().then(o.bind(o,926))}},e=>{e.O(0,[619,239,441,255,358],()=>e(e.s=6235)),_N_E=e.O()}]);